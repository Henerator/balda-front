<!-- TODO: add loading state -->

<app-join-form
  *ngIf="!room"
  (formSubmit)="onJoinSubmit($event)"
></app-join-form>

<ng-container *ngIf="room">
  <ng-container [ngSwitch]="room.state">
    <div *ngSwitchCase="'waitingPlayers'">Waiting players</div>

    <div *ngSwitchCase="'game'">
      <app-room-field
        [matrix]="matrix"
        [editable]="gameState === gameStates.addLetter"
        [selectable]="gameState === gameStates.selectWord"
        (letterChanged)="onAddLeter($event)"
        (positionsSelected)="onPositionsSelected($event)"
      ></app-room-field>

      <div
        *ngIf="gameState === gameStates.selectWord && changedLetter"
        class="margin-t-sm"
      >
        <button (click)="onApplyWord()" class="button primary margin-b-sm">
          Apply
        </button>
        <button (click)="onCancelWord()" class="button secondary">
          Cancel
        </button>
      </div>

      <div>Room state: {{ room.state }}</div>
      <div>Game state: {{ gameState }}</div>
      <div>Current player: {{ room.currentPlayerName }}</div>

      <div class="players-list">
        <app-player-statistics
          *ngFor="let player of room.players"
          [player]="player"
        ></app-player-statistics>
      </div>
    </div>

    <div *ngSwitchCase="'gameEnd'">Game end</div>
  </ng-container>
</ng-container>
